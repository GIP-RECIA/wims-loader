{# templates/web/teacher.html.twig #}
{% extends 'base.html.twig' %}
{% set title_page = 'Détails de la classe' %}

{% block style %}
<style>
    .wims_loader_label {
        font-weight: bold;
    }

    .full_width {
        width: 100%;
    }

    ul.wims_loader_class_ul {
        width: 100%;
    }

    ul.wims_loader_class_ul li.field.box {
        min-height: auto;
    }

    .two-col {
        width: 50%;
    }

    .bloc-students li {
        padding: 2px;
        margin-bottom: 4px;
    }

    .bloc-students .ok {
        background-color: #BBFFBB;
    }

    .bloc-students .nok-warn {
        background-color: #FFFFBB;
    }

    .bloc-students .nok-error {
        background-color: #FFBBBB;
    }
</style>
{% endblock %}

{% block body %}
<fieldset class="property_fields blockcenter">
    <legend>Établissement</legend>
    <ul class="flex_box wims_loader_class_ul">
        <li class="field box halfwidth">
            <span class="wims_loader_label">UAI de l'établissement :</span> {{ groupingClasses.uai }}
        </li>
        <li class="field box halfwidth">
            <span class="wims_loader_label">Nom de l'établissement :</span> {{ groupingClasses.name }}
        </li>
    </ul>
</fieldset>
<fieldset class="property_fields blockcenter">
    <legend>Classe</legend>
    <ul class="flex_box wims_loader_class_ul">
        <li class="field box halfwidth">
            <span class="wims_loader_label">Nom de la classe :</span> {{ class.name }}
        </li>
        <li class="field box halfwidth">
            <span class="wims_loader_label">Nom de l'enseignant :</span> {{ class.teacher.lastName }} {{ class.teacher.firstName }}
        </li>
        <li class="field box halfwidth">
            <span class="wims_loader_label">Matière(s) :</span> {{ class.subjects }}
        </li>
        <li class="field box halfwidth">
            <span class="wims_loader_label">ID wims :</span> {{ class.fullIdWims }}
        </li>
        <li class="field box halfwidth">
            <span class="wims_loader_label">Derniére synchro :</span> {{ class.lastSyncAt|date('H:i d/m/y') }}
        </li>
    </ul>
</fieldset>
<fieldset class="property_fields blockcenter bloc-students">
    <legend>Élèves</legend>
    <div class="two-col">
        <p>Dans wims :</p>
        <ul>
        {% for key, user in usersInWims %}
            <li class="{% if key in uidCommon %}ok{% else %}nok-warn{% endif %}">{{ user.lastName }} {{ user.firstName }}</li>
        {% endfor %}
        </ul>
    </div>
    <div class="two-col">
        <p>Dans l'annuaire :</p>
        <ul>
        {% for key, user in usersInLdap %}
            <li class="{% if key in uidCommon %}ok{% else %}nok-error{% endif %}">{{ user.getAttribute('sn')|first }} {{ user.getAttribute('givenName')|first }}</li>
        {% endfor %}
        </ul>
    </div>
</fieldset>
{% if usersInWims|length == uidCommon|length and usersInLdap|length == uidCommon|length %}
<div class="wims_msg info">Les élèves sont bien synghronisés</div>
{% else %}
<div class="wims_msg alert">Certains élèves ne sont pas synchronisés</div>
{% endif %}
<div class="wimscenter actions">
    {#<a href="{{ url('teacher') }}" class="wims_button" role="button">Synchroniser</a>#}
    <a href="{{ url('teacher') }}" class="wims_button wims_secondary_button" role="button">Retour</a>
</div>


{% endblock %}